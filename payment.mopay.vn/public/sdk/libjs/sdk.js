!function(a){"use strict";function t(a){return this instanceof t?(this.reset.call(this),this.init.call(this,a),this):new t(a)}var e=window.document,s={channel:"1|me",telco:"vms",platform:"web",lang:"vi"},n={timeout:3e5,data:{},remove:function(a){delete n.data[a]},exist:function(a){return!!n.data[a]&&(new Date).getTime()-n.data[a]._<n.timeout},get:function(a){return n.data[a].data},set:function(t,e,s){n.remove(t),n.data[t]={_:(new Date).getTime(),data:e},a.isFunction(s)&&s(e)}};t.prototype={reset:function(){return this.opts=null,this.$container=null,this.container=null,this.data=null,this},init:function(a){var t=this;this.opts=jsME.extend({},s,a),this._api_url="https://payment.mopay.vn/",this._api_url_v3="https://payment.mopay.vn/v3/",this._app=t.opts.app,this._key="DZHBZJI7TPOOE6QE",this.data=null,this.$mycache={},this.opts.loadCss(t.opts.URL_LIB+"css/style.css"),this.container=e.getElementById("mopay_sdk"),this.$container=jsME(this.container),this.container="",this.eventBack="",this.nowCallBack="listmopay",this.keyCache="",this.keyCache_balance="balance",this.params={user_agent:a.user_agent,access_token:a.accessToken,ip:a.ip,app:t._app,dev:a.dev,version:1,channel:a.channel,telco:t.opts.telco,platform:a.platform,lang:a.lang,info:a.info,service_id:t.opts.service_id},t.danhsachcongthanhtoan.call(t),this.$container.on("click.hb","#payexject",function(a){}).on("click.hb","#listmopay",function(){jsME(this);t.listmopay.call(t)}).on("click.hb","#mol-close",function(){jsME(this);t.closet.call(t)}).on("click.hb","#item_mopay",function(){jsME(this);t.danhsachcongthanhtoan.call(t)}).on("click.hb","#item_list_payment",function(){jsME(this);t.opts.id_item_payment=jsME(this).attr("gdata"),t.opts.g_identify=jsME(this).attr("g-identify"),"mopay_wallet_category"==t.opts.g_identify?t.opts.id_item_wallet=jsME(this).attr("gdata"):t.opts.id_item_wallet=0,t.opts.g_action_root=jsME(this).attr("g-action-root"),t.danhsachlistpayment.call(t)}).on("click.hb","#item_list_payment_wallet",function(){jsME(this);t.opts.id_item_payment=jsME(this).attr("gdata"),t.opts.g_identify=jsME(this).attr("g-identify"),t.opts.g_action_root=jsME(this).attr("g-action-root"),t.danhsachlistpayment_wallet.call(t)}).on("click.hb","#item_list_payment_detail",function(){jsME(this);t.opts.g_service="",t.opts.id_item_payment=jsME(this).attr("gdata"),t.opts.id_item_payment_detail=jsME(this).attr("gdata-detail"),t.opts.g_identify=jsME(this).attr("g-identify"),t.opts.g_service=jsME(this).attr("g-service"),t.opts.g_direct=0,t.opts.g_direct=jsME(this).attr("g-direct");var a=jsME(this).attr("g-action");t.opts.g_action=a,t.frompaymentitem.call(t)}).on("click.hb","#item_list_wallet_detail",function(){jsME(this);t.opts.id_item_payment=jsME(this).attr("gdata"),t.opts.id_item_wallet=jsME(this).attr("gdata-parent"),t.opts.id_item_payment_detail=jsME(this).attr("gdata-detail"),t.opts.g_identify=jsME(this).attr("g-identify"),t.opts.g_direct=0,t.opts.g_direct=jsME(this).attr("g-direct");var a=jsME(this).attr("g-action");t.opts.g_action=a,t.fromnapvi.call(t)}).on("click.hb","#item_list_payment_wallet_detail",function(){jsME(this);t.opts.id_item_payment=jsME(this).attr("gdata"),t.opts.id_item_payment_detail=jsME(this).attr("gdata-detail"),t.opts.g_identify=jsME(this).attr("g-identify"),t.opts.g_direct=0,t.opts.g_direct=jsME(this).attr("g-direct"),t.opts.g_service=jsME(this).attr("g-service");var a=jsME(this).attr("g-action");t.opts.g_action=a,t.frompaymentitemwallet.call(t)}).on("click.hb",".msdk_btn_orange.sd_vimobay",function(){t.alertsudungvi.call(t)}).on("click.hb",".input-card",function(){t.alertcard.call(t)}).on("click.hb",".input-bank",function(){t.alertbank.call(t)}).on("click.hb","#clear_codepin,clear_seri",function(){jsME(this).next(".msdk_input_text").val("")}).on("keyup mouseout",".number_seri",function(){var a=jsME(this).val(),t=a.length;t>0?jsME("#clear_seri").show():jsME("#clear_seri").hide()}).on("keyup mouseout",".codepin",function(){var a=jsME(this).val(),t=a.length;t>0?jsME("#clear_codepin").show():jsME("#clear_codepin").hide()}).on("click.hb",".callBack",function(){var a=(jsME(this),jsME(this).attr("call-data"));"danhsachlistpayment"==a&&t.danhsachlistpayment.call(t),"danhsachcongthanhtoan"==a&&t.danhsachcongthanhtoan.call(t),"danhsachtygia"==a&&t.danhsachtygia.call(t),"congthanhtoan"==a&&t.danhsachvimobay.call(t),"danhsachvimobay"==a&&t.danhsachvimobay.call(t),"fromnapvi"==a&&t.fromnapvi.call(t),"closeconfirim"==a&&jsME(".pop_confirm").remove(),"danhsachlistpayment_wallet"==a&&t.danhsachlistpayment_wallet.call(t)}).on("click.hb","#cahe",function(){t.callCache.call(t)})},ApiInfor:function(){var t=this,e={control:"adapter",user_agent:t.opts.user_agent,access_token:t.opts.accessToken,app:t._app,dev:t.opts.dev,version:1,telco:t.opts.telco,channel:t.opts.channel,platform:t.opts.platform,lang:t.opts.lang,service_id:t.opts.service_id},s=a.param(e),n=t._api_url_v3+"?"+s;return n},callInfo:function(){var a=this;a.ApiInfor.call(a)},callBalance:function(){var a=this,t=a.ApiInfor.call(a);jsME.ajax({url:t,type:"GET",dataType:"jsonp",jsonpCallback:"balance",jsonp:!1,cache:!0,data:{func:"balance",callback:"balance"},timeout:1e4}).done(function(t){return n.set(a.opts.keyCache_balance,t),t}).error(function(t,e,s){a.Eerror.call(e,s,t)})},callListGame:function(){var t=this,e={control:"adapter",user_agent:t.opts.user_agent,access_token:t.opts.accessToken,app:t._app,dev:t.opts.dev,version:1,telco:t.opts.telco,service_id:t.opts.service_id,channel:t.opts.channel,platform:t.opts.platform,lang:t.opts.lang};e.func="get_items",e.callback="get_items";var s=a.param(e),n=t._api_url_v3+"?"+s;return n},callCache:function(){var a=this;if(n.exist(a.opts.keyCache));else{var t=a.callApi.call(a);jsME.ajax({url:t,type:"GET",dataType:"jsonp",jsonpCallback:a.params.callback,jsonp:!1,cache:"true",timeout:1e4,beforeSend:a.startLoading.call(a),complete:a.topLoading.call(a)}).done(function(t){n.set(a.opts.keyCache,t)}).error(function(t,e,s){a.Eerror.call(e,s,t)})}},closet:function(){var a=this;a.$container.html("")},Eerror:function(a,t,e){},callApi:function(){var t=this;t.params.control="adapter",t.params.token=jsME.md5(t.params+""+t._key);var e=a.param(t.params),s=t._api_url_v3+"?"+e;return s},cancelDefaultAction:function(a){return!1},checkSDK:function(){var a=this;(""===a.opts.accessToken||""===a.opts.secret)&&(window.location.href=a.opts.URL_CALLBACK)},enableButtons:function(){this.$container.find("#payexject").prop("disabled",!0)},listmopay:function(){var a=this;a.opts.loadScript(options.URL_TEMPLATE+"template.js?t="+a.opts.T,function(){a.opts.nowCallBack="listmobay",a.opts.eventBack="",a.params.func="payment_type",a.params.callback="payment_type";var t=a.callApi.call(a);jsME.ajax({url:t,type:"GET",dataType:"jsonp",jsonpCallback:a.params.callback,jsonp:!1,cache:"false",timeout:1e4,beforeSend:a.startLoading.call(a),complete:a.topLoading.call(a)}).done(function(t){a.data=t,a.data.data.app_name?a.opts.title=a.data.data.app_name:a.opts.title="Iwin Online";var e=new template(a.opts);e.view("list-mopay",a)}).error(function(t,e,s){a.Eerror.call(e,s,t)})})},danhsachtygia:function(){var a=this;a.opts.nowCallBack="danhsachtygia",a.opts.eventBack="listmopay",a.params.func="payment_exchange",a.params.callback="payment_exchange";var t=a.callApi.call(a);jsME.ajax({url:t,type:"GET",dataType:"jsonp",jsonpCallback:a.params.callback,jsonp:!1,cache:"false",timeout:1e4,beforeSend:a.startLoading.call(a),complete:a.topLoading.call(a)}).done(function(t){a.data=t,a.opts.eventBack="listmopay";var e=new template(a.opts);e.view("danh-sach-ty-gia",a)}).error(function(t,e,s){a.Eerror.call(e,s,t)})},danhsachcongthanhtoan:function(){var a=this;a.opts.loadScript(a.opts.URL_TEMPLATE+"template.js?t="+a.opts.T,function(){a.opts.nowCallBack="danhsachcongthanhtoan",a.opts.eventBack="listmopay",a.params.func="payment_list",a.params.callback="payment_list";var t=a.callApi.call(a);a.opts.keyCache="payment_list",jsME.ajax({url:t,type:"GET",async:!1,dataType:"jsonp",jsonpCallback:a.params.callback,jsonp:!1,cache:!0,beforeSend:a.startLoading.call(a),complete:a.topLoading.call(a)}).success(function(t){n.set(a.opts.keyCache,t),a.data=t,a.data.data.app_name?a.opts.title=a.data.data.app_name:a.opts.title="Iwin Online",a.opts.Id_mobo=a.data.data.mobo_id;var e=new template(a.opts);e.view("danh-sach-cong-thanh-toan",a)}).error(function(a,t,e){console.log(t+","+e+","+a.responseText)})})},danhsachlistpayment:function(){var a=this;if(a.opts.eventBack="danhsachcongthanhtoan",a.opts.nowCallBack="danhsachlistpayment",a.opts.keyCache="payment_list",n.exist(a.opts.keyCache)){var t=n.get(a.opts.keyCache);a.data=t.data.data[a.opts.id_item_payment],a.opts.title=a.data.title;var e=new template(a.opts);"mopay_wallet_category"==a.opts.g_identify?(a.callBalance.call(a),setTimeout(function(){var t=n.get(a.opts.keyCache_balance);a.opts.balance=t,e.view("danh-sach-vi-mopay",a)},500)):e.view("danh-sach-list-pay-ment",a)}else{a.params.func="payment_list",a.params.callback="payment_list";a.callApi.call(a);a.callCache.call(a),setTimeout(function(){var t=n.get(a.opts.keyCache);a.data=t.data.data[a.opts.id_item_payment],a.opts.title=a.data.title;var e=new template(a.opts);"mopay_wallet_category"==a.opts.g_identify?setTimeout(function(){var t=n.get(a.opts.keyCache_balance);a.opts.balance=t,e.view("danh-sach-vi-mopay",a)},1e3):e.view("danh-sach-list-pay-ment",a)},200)}},danhsachlistpayment_wallet:function(){var a=this;a.opts.eventBack="fromnapvi",a.opts.nowCallBack="danhsachlistpayment",a.params.func="payment_list",a.params.callback="payment_list",a.opts.keyCache="payment_list";a.callApi.call(a);if(n.exist(a.opts.keyCache)){var t=n.get(a.opts.keyCache);a.data=t.data.data[a.opts.id_item_payment],a.opts.title=a.data.title;var e=new template(a.opts);e.view("danh-sach-list-pay-ment-wallet",a)}else{a.params.func="payment_list",a.params.callback="payment_list";a.callApi.call(a);a.callCache.call(a),setTimeout(function(){var t=n.get(a.opts.keyCache);a.data=t.data.data[a.opts.id_item_payment],a.opts.title=a.data.title;var e=new template(a.opts);e.view("danh-sach-list-pay-ment-wallet",a)},200)}},danhsachvimobay:function(){var a=this;if(a.opts.eventBack="danhsachcongthanhtoan",a.opts.nowCallBack="danhsachlistpayment",a.params.func="payment_list",a.params.callback="payment_list",a.opts.keyCache="payment_list",a.callBalance.call(a),n.exist(a.opts.keyCache))setTimeout(function(){var t=n.get(a.opts.keyCache);a.opts.id_item_wallet?a.data=t.data.data[a.opts.id_item_wallet]:(alert(a.opts.id_item_payment),a.data=t.data.data[a.opts.id_item_payment]),a.opts.title=a.data.title;var e=n.get(a.opts.keyCache_balance);a.opts.balance=e;var s=new template(a.opts);s.view("danh-sach-vi-mopay",a)},500);else{a.callApi.call(a);a.callCache.call(a),setTimeout(function(){var t=n.get(a.opts.keyCache);a.data=t.data.data[a.opts.id_item_payment],a.opts.title=a.data.title;var e=n.get(a.opts.keyCache_balance);a.opts.balance=e;var s=new template(a.opts);s.view("danh-sach-vi-mopay",a)},200)}},frompaymentitem:function(){var a=this;if(a.opts.eventBack="danhsachlistpayment",a.opts.nowCallBack="frompaymentcard",a.params.func="payment_list",a.params.callback="payment_list",a.opts.keyCache="payment_list",n.exist(a.opts.keyCache)){var t=n.get(a.opts.keyCache);a.data=t.data.data[a.opts.id_item_payment].data[a.opts.id_item_payment_detail],a.opts.title=a.data.title;var e=new template(a.opts);"pay_card"==a.opts.g_action?(a.opts.telco=a.data.options.card,a.data="",e.view("from-payment-card",a)):"pay_ibanking"==a.opts.g_action?e.view("from-payment-bank",a):"pay_sms"==a.opts.g_action&&a.fromsms.call(a)}else{a.callApi.call(a);a.callCache.call(a),setTimeout(function(){var t=n.get(a.opts.keyCache);a.data=t.data.data[a.opts.id_item_payment].data[a.opts.id_item_payment_detail],a.opts.title=a.data.title;var e=new template(a.opts);"pay_card"==a.opts.g_action?(a.opts.telco=a.data.options.card,a.data="",e.view("from-payment-card",a)):"pay_ibanking"==a.opts.g_action?e.view("from-payment-bank",a):"pay_sms"==a.opts.g_action&&a.fromsms.call(a)},200)}},frompaymentitemwallet:function(){var a=this;if(a.opts.eventBack="danhsachlistpayment_wallet",a.opts.nowCallBack="frompaymentitemwallet",a.params.func="payment_list",a.params.callback="payment_list",a.opts.keyCache="payment_list",n.exist(a.opts.keyCache)){var t=n.get(a.opts.keyCache);a.data=t.data.data[a.opts.id_item_payment].data[a.opts.id_item_payment_detail],a.opts.title=a.data.title;var e=new template(a.opts);"pay_card"==a.opts.g_action?(a.opts.telco=a.data.options.card,a.data="",e.view("from-payment-card",a)):"pay_ibanking"==a.opts.g_action?e.view("from-payment-bank",a):"pay_sms"==a.opts.g_action&&a.fromsms.call(a)}else a.callCache.call(a),setTimeout(function(){var t=n.get(a.opts.keyCache);a.data=t.data.data[a.opts.id_item_payment].data[a.opts.id_item_payment_detail],a.opts.title=a.data.data.title;var e=new template(a.opts);"pay_card"==a.opts.g_action?(a.opts.telco=a.data.data.options.card,a.data="",e.view("from-payment-card",a)):"pay_ibanking"==a.opts.g_action?e.view("from-payment-bank",a):"pay_sms"==a.opts.g_action&&a.fromsms.call(a)},200)},fromsms:function(){var a=this;a.params.lang=a.opts.lang,a.params.func="get_sms_content",a.params.callback="get_sms_content";var t=a.callApi.call(a);if(""!=a.opts.g_service&&a.opts.g_service.length>5){new template(a.opts);jsME.ajax({url:t,type:"GET",dataType:"jsonp",jsonpCallback:a.params.callback,jsonp:!1,cache:!0,data:{service_number:a.opts.g_service},beforeSend:a.startLoading.call(a),complete:a.topLoading.call(a)}).done(function(t){a.opts.title="SMS",110!=t.code&&(a.opts.title="Thất bại");var e=new template(a.opts);a.datasms=t,e.view("alert-sms",a)}).error(function(t,e,s){a.Eerror.call(e,s,t)})}},fromnapvi:function(){var a=this,a=this;if(a.opts.eventBack="congthanhtoan",a.opts.nowCallBack="fromnapvi",a.params.func="payment_list",a.params.callback="payment_list",a.opts.keyCache="payment_list",n.exist(a.opts.keyCache)){var t=n.get(a.opts.keyCache);a.data=t,a.opts.title=t.data.title;var e=new template(a.opts);"pay_wallet"==a.opts.g_action?a.fromsudungvi.call(a):e.view("from-nap-vi",a)}else a.callCache.call(a),setTimeout(function(){var t=n.get(a.opts.keyCache);a.data=t,a.opts.title=t.data.title;var e=new template(a.opts);"pay_wallet"==a.opts.g_action?a.fromsudungvi.call(a):e.view("from-nap-vi",a)},200)},fromsudungvi:function(){var a=this;if(a.opts.keyCache="game_list",a.callBalance.call(a),n.exist(a.opts.keyCache)){var t=new template(a.opts),e=n.get(a.opts.keyCache);a.data=e,t.view("from-su-dung-vi",a)}else{var s=a.callListGame.call(a);jsME.ajax({url:s,type:"GET",dataType:"jsonp",jsonpCallback:"get_items",jsonp:!1,cache:!0,beforeSend:a.startLoading.call(a),complete:a.topLoading.call(a)}).done(function(t){n.set(a.opts.keyCache,t);var e=new template(a.opts);a.data=t,e.view("from-su-dung-vi",a)}).error(function(t,e,s){a.Eerror.call(e,s,t)})}},alertsudungvi:function(){var a=this,t=jsME("#bitcoid").val(),e=jsME("#bitcoid").attr("data-code-id");if(""!=t&&""!=e){jsME("#choose_item").css("border","1px solid #c6c6c6"),a.params.func="purchase_item",a.params.callback="purchase_item";var s=a.callApi.call(a);jsME.ajax({url:s,type:"GET",async:!0,dataType:"jsonp",contentType:"application/json",jsonpCallback:a.params.callback,jsonp:!1,cache:!0,data:{item_id:e,lang:a.opts.lang},beforeSend:a.startLoading.call(a),complete:a.topLoading.call(a)}).done(function(t){a.opts.title="Thành công",110!=t.code&&(a.opts.title="Thất bại");var e=new template(a.opts);a.data=t,e.view("alert-su-dung-vi",a)}).error(function(t,e,s){a.Eerror.call(e,s,t)})}else jsME("#choose_item").css("border","1px solid #ff0000")},alertcard:function(){var a=this;jsME(".msdk_lbl").css("color","#3d3d3d");var t=jsME(".number_seri").val(),e=jsME("#type_telco").val(),s=0;s=jsME("#direct_type").val();var n=jsME(".codepin").val();if(""!=n&&""!=t){a.params.lang=a.opts.lang,a.params.func="verify_card",a.params.telco=e,a.params.callback="verify_card";var o=a.callApi.call(a);jsME.ajax({url:o,type:"GET",dataType:"jsonp",jsonpCallback:a.params.callback,crossDomain:!0,jsonp:!1,cache:"true",data:{serial:t,pin:n,direct:s},beforeSend:a.startLoading.call(a),complete:a.topLoading.call(a)}).done(function(s){var o=new template(a.opts);a.data=s,a.serial=t,a.pin=n,a.opts.telco=e,a.code=s.code,o.view("alert-card-succes",a),o.view("alert-card-succes",a)}).error(function(t,e,s){a.Eerror.call(e,s,t)})}else jsME(".msdk_lbl").css("color","#ff0000")},alertbank:function(){var a=this;jsME(".msdk_input_section").css("border","1px solid #c6c6c6");var t=jsME("#bitcoid").val(),e=jsME("#bank_type").val(),s=jsME("#bank_code").val(),n=0;if(n=jsME("#direct_type").val(),""!=t&&""!=e&&""!=s){a.params.lang=a.opts.lang,a.params.func="get_link_banking",a.params.callback="get_link_banking";var o=a.callApi.call(a);jsME.ajax({url:o,type:"GET",dataType:"jsonp",jsonpCallback:a.params.callback,crossDomain:!0,jsonp:!1,cache:"true",data:{money:t,bank_type:e,bank_code:s,direct:n},beforeSend:a.startLoading.call(a),complete:a.topLoading.call(a)}).done(function(t){var e=new template(a.opts);a.databank=t,e.view("alert-payment-bank",a)}).error(function(t,e,s){a.Eerror.call(e,s,t)})}else jsME(".msdk_input_section").css("border","1px solid #c6c6c6")},startLoading:function(){jsME("#msdk_loadding").addClass("msdk_myModal_loadding"),jsME("#msdk_loadding").show(),jsME(".sdk_img_loading").show()},topLoading:function(){jsME("#msdk_loadding").removeClass("msdk_myModal_loadding"),jsME("#msdk_loadding").hide(),jsME(".sdk_img_loading").hide()},writelog:function(a){}},window.ME=t}(jQuery);